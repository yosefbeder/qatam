# ترجع شريحة من "قيمة"
# إنتبه:
# - يمكن ل"قيمة" أن تكون نصاً أو قائمةً فقط.
# - يجب أن تكون قيمة "البداية" أقل من "النهاية"
صدّر دالة شرّح(قيمة، البداية = 0، النهاية = عدم) {
  إن (!النهاية) {
    النهاية = حجم(قيمة)
  }
  متغير الناتج، عداد = البداية
  إن(نوع(قيمة) == "نص") { الناتج = "" }
  إلا { الناتج = [] }
  طالما(عداد < النهاية) {
    إن (نوع(قيمة) == "نص") { الناتج += قيمة[عداد] }
    إلا { إدفع(الناتج، قيمة[عداد]) }
    عداد += 1
  }
  أرجع الناتج
}
# إطبع(شرّح("السلام عليكم"، 7))

# ترجع قائمة تحتوي على جميع القيم بين "البداية" و"النهاية" حيث أن الفرق بين كل قيمة وتاليتها "خطوة".
# إنتبه: يجب أن تكون قيمة "البداية" أقل من "النهاية"
صدّر دالة مدى(البداية، النهاية، خطوة = 1) {
  متغير عداد = البداية
  متغير الناتج = []
  طالما(عداد < النهاية) {
    إدفع(الناتج، عداد)
    عداد += خطوة
  }
  أرجع الناتج
}
# إطبع(مدى(0، 2))

# ترجع نسخة معكوسة من "قائمة"
صدّر دالة إعكس(قائمة) {
  متغير الناتج = []، عداد = حجم(قائمة)
  طالما(عداد > 0) {
    إدفع(الناتج، قائمة[عداد - 1])
    عداد -= 1
  }
  أرجع الناتج
}
# إطبع(إعكس(مدى(0، 10)))

# ترجع القائمة الناتجة من تطبيق "محول" على كل عنصر من "قائمة"
صدّر دالة حوّل(قائمة، محوّل) {
  متغير الناتج = []، عداد = 0
  طالما(عداد < حجم(قائمة)) {
    إدفع(الناتج، محوّل(قائمة[عداد]، عداد))
    عداد += 1
  }
  أرجع الناتج
}
# إطبع(حوّل(مدى(0، 10)، |عنصر، _| { أرجع عنصر * 2 }))

# ترجع قائمة تحتوي فقط على العناصر التي ترجع قيمة صحيحة عند تطبيق دالة "مرشّح" عليها
صدّر دالة رشّح(قائمة، مرشّح) {
  متغير الناتج = []، عداد = 0
  طالما(عداد < حجم(قائمة)) {
    متغير عنصر = قائمة[عداد]
    إن(مرشّح(عنصر، عداد)) {
      إدفع(الناتج، عنصر)
    }
    عداد += 1
  }
  أرجع الناتج
}
# إطبع(رشّح(مدى(0، 10)، |عنصر، _| { أرجع كصحيح(عنصر / 2) == عنصر / 2 }))

# ترجع القيمة الناتجة عن إختزال جميع عناصر "قائمة" بواسطة "مختزل".
صدّر دالة إختزل(قائمة، مختزل، القيمة_الأولية = 0) {
  متغير إلى_الآن = القيمة_الأولية، عداد = 0
  طالما(عداد < حجم(قائمة)) {
    إلى_الآن = مختزل(إلى_الآن، قائمة[عداد]، عداد)
    عداد += 1
  }
  أرجع إلى_الآن
}
# دالة فاكتوريال(عدد) {
#   أرجع إختزل(مدى(1، عدد + 1)، |إلى_الآن، عنصر، _| { أرجع إلى_الآن * عنصر }، 1)
# }
# إطبع(فاكتوريال(170))

# تتأكد من أن كل عناصر "قائمة" ترجع قيمة صحيحة ناتجة عن تطبيق "محدد" عليها.
صدّر دالة كل(قائمة، محدد) {
  متغير عداد = 0
  طالما(عداد < حجم(قائمة)) {
    إن(!محدد(قائمة[عداد]، عداد)) {
      أرجع خطأ
    }
    عداد += 1
  }
  أرجع صحيح
}

# تتأكد من أنه هنالك عنصر واحد على الأقل يرجع قيمة صحيحة نتيجة تطبيق ال"محدد" عليه.
صدّر دالة أي(قائمة، محدد) {
  متغير عداد = 0
  طالما(عداد < حجم(قائمة)) {
    إن(محدد(قائمة[عداد]، عداد)) {
      أرجع صحيح
    }
    عداد += 1
  }
  أرجع خطأ
}

# دالة قابل_للقسمة_على(مقسوم_عليه) {
#   أرجع |عدد، _| { أرجع عدد / مقسوم_عليه == كصحيح(عدد / مقسوم_عليه) }
# }
# إطبع(كل(مدى(2، 10)، قابل_للقسمة_على(2)))
# إطبع(كل(مدى(2، 10، 2)، قابل_للقسمة_على(2)))
# إطبع(أي(مدى(2، 10، 2)، قابل_للقسمة_على(5)))
# إطبع(أي(مدى(2، 10)، قابل_للقسمة_على(5)))

# ترجع رقم أول عنصر تجده في "قائمة" يطبق "محدد"
صدّر دالة إبحث(قائمة، محدد) {
  متغير عداد = 0
  طالما(عداد < حجم(قائمة)) {
    إن(محدد(قائمة[عداد]، عداد)) {
      أرجع عداد
    }
    عداد += 1
  }
  أرجع عدم
}
# إطبع(إبحث(مدى(0، 5)، |عنصر، _| { أرجع عنصر == 4 }))

# تقوم بدمج قائمتين مرتبتين
دالة إدمج(القائمة_اليمنى، القائمة_اليسرى، مقارنة) {
  متغير الناتج = []، الأيمن = 0، الأيسر = 0
  طالما(الأيمن < حجم(القائمة_اليمنى) و الأيسر < حجم(القائمة_اليسرى)) {
    إن (مقارنة(القائمة_اليمنى[الأيمن]، القائمة_اليسرى[الأيسر]) < 1) {
      إدفع(الناتج، القائمة_اليمنى[الأيمن])
      الأيمن += 1
    } إلا {
      إدفع(الناتج، القائمة_اليسرى[الأيسر])
      الأيسر += 1
    }
  }
  إن(الأيمن != حجم(القائمة_اليمنى)) {
    طالما(الأيمن < حجم(القائمة_اليمنى)) {
      إدفع(الناتج، القائمة_اليمنى[الأيمن])
      الأيمن += 1
    }
  } وإن(الأيسر != حجم(القائمة_اليسرى)) {
    طالما(الأيسر < حجم(القائمة_اليسرى)) {
      إدفع(الناتج، القائمة_اليسرى[الأيسر])
      الأيسر += 1
    }
  }
  أرجع الناتج
}

# ترجع نسخة مرتبة من "قائمة"
# "مقارنة" هي دالة تطبق على كل عنصر في "قائمة" وترجع رقماً.
# إن كانت القيمة المرجعة موجبة أو صفراً فهذا يعني أن العنصر "الأيمن" سيتقدم في الترتيب على "الأيسر".
# وإن كانت سالبة فهذا يعني أن العكس سيحدث.
صدّر دالة رتّب(قائمة، مقارنة) {
  إن(حجم(قائمة) < 2) {
    أرجع قائمة
  }
  متغير الوسط = كصحيح(حجم(قائمة) / 2)
  متغير القائمة_اليمنى = رتّب(شرّح(قائمة، 0، الوسط)، مقارنة)
  متغير القائمة_اليسرى = رتّب(شرّح(قائمة، الوسط)، مقارنة)
  أرجع إدمج(القائمة_اليمنى، القائمة_اليسرى، مقارنة)
}
# دالة أنشئ_شخص(الاسم، العمر) { أرجع { الاسم، العمر } }
# متغير أشخاص = [أنشئ_شخص("يوسف"، 16)، أنشئ_شخص("مصطفى"، 18)، أنشئ_شخص("أسامة"، 16)، # أنشئ_شخص("إسماعيل"، 15)، أنشئ_شخص("زوزو"، 12)، أنشئ_شخص("أنس"، 15)]
# إطبع(رتّب(أشخاص، |{ العمر: عمر_الأيمن }، { العمر: عمر_الأيسر }| { أرجع عمر_الأيمن - عمر_الأيسر }))
# إطبع(رتّب(أشخاص، |{ العمر: عمر_الأيمن }، { العمر: عمر_الأيسر }| { أرجع عمر_الأيسر - عمر_الأيمن }))

# تقوم بإنشاء نصٍ ناتج عن دمج "قالب" مع "القيم"
صدّر دالة نسّق(قالب، القيم) {
  ألقي "لم تكتب بعد"
}